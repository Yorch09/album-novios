<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>√Ålbum por Misiones üíå</title>
  <style>
    body {
      font-family: sans-serif;
      background: #fefaf5;
      padding: 20px;
    }

    h1 {
      text-align: center;
      font-size: 2em;
      margin-bottom: 10px;
    }

    #pagina-tema {
      text-align: center;
      font-size: 1.2em;
      margin-bottom: 10px;
      font-weight: bold;
    }

    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
      gap: 15px;
      max-width: 1000px;
      margin: auto;
    }

    .card {
      perspective: 1000px;
    }

    .card-inner {
      position: relative;
      width: 100%;
      padding-top: 140%; /* relaci√≥n 7:5 */
      transform-style: preserve-3d;
      transition: transform 0.6s;
    }

    .card.flipped .card-inner {
      transform: rotateY(180deg);
    }

    .card-front, .card-back {
      position: absolute;
      top: 0; left: 0; right: 0; bottom: 0;
      backface-visibility: hidden;
      border-radius: 10px;
      box-shadow: 0 4px 8px rgba(0,0,0,0.2);
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 10px;
      box-sizing: border-box;
    }

    .card-front {
      background: url('imgs/Fondo_carta.jpg') center/contain no-repeat, #ffecf0;

      flex-direction: column;
      font-weight: bold;
      font-size: 0.9em;
      text-align: center;
    }

    .card-back {
      background: white;
      transform: rotateY(180deg);
      flex-direction: column;
      text-align: center;
    }

    .card-back img {
      width: 100%;
      border-radius: 8px;
      margin-top: 10px;
    }

    .card.locked .card-front {
      filter: grayscale(100%);
      cursor: not-allowed;
    }

    .card:not(.locked) .card-front {
      cursor: pointer;
    }

    input[type="file"] {
      margin-top: 10px;
    }

    button {
      margin-top: 10px;
      padding: 5px 10px;
      border: none;
      background: #ff4081;
      color: white;
      border-radius: 5px;
      cursor: pointer;
    }

    button:hover {
      background: #d81b60;
    }

    .navegacion {
      text-align: center;
      margin-top: 20px;
    }

    .navegacion button {
      margin: 0 10px;
      padding: 8px 15px;
      background: #007bff;
      border: none;
      color: white;
      border-radius: 6px;
      cursor: pointer;
    }

    .navegacion button:hover {
      background: #0056b3;
    }
  </style>
</head>
<body>

<h1>√Ålbum de Misiones üíå</h1>
<div id="pagina-tema"></div>
<div class="grid" id="grid-misiones"></div>

<div class="navegacion">
  <button onclick="cambiarPagina(-1)">‚¨ÖÔ∏è Anterior</button>
  <span id="pagina-actual"></span>
  <button onclick="cambiarPagina(1)">Siguiente ‚û°Ô∏è</button>
</div>

<script>
  const album = [
    {
      tema: "Comienzos üíû",
      misiones: Array.from({ length: 15 }, (_, i) => ({
        nombre: `Comienzo ${i + 1}`,
        estado: i === 0 ? "desbloqueada" : "bloqueada",
        imagen: null
      }))
    },
    {
      tema: "Aventuras üåç",
      misiones: Array.from({ length: 15 }, (_, i) => ({
        nombre: `Aventura ${i + 1}`,
        estado: "bloqueada",
        imagen: null
      }))
    },
    {
      tema: "Detalles ‚ú®",
      misiones: Array.from({ length: 15 }, (_, i) => ({
        nombre: `Detalle ${i + 1}`,
        estado: "bloqueada",
        imagen: null
      }))
    },
    {
      tema: "Celebraciones üéâ",
      misiones: Array.from({ length: 15 }, (_, i) => ({
        nombre: `Fiesta ${i + 1}`,
        estado: "bloqueada",
        imagen: null
      }))
    },
    {
      tema: "Nuestros Momentos üíñ",
      misiones: Array.from({ length: 15 }, (_, i) => ({
        nombre: `Momento ${i + 1}`,
        estado: "bloqueada",
        imagen: null
      }))
    }
  ];

  let paginaActual = 0;

  function renderizarAlbum() {
    const seccion = album[paginaActual];
    document.getElementById('pagina-tema').textContent = `Tema: ${seccion.tema}`;
    document.getElementById('pagina-actual').textContent = `P√°gina ${paginaActual + 1} / ${album.length}`;
    renderizarMisiones(seccion.misiones);
  }

  function cambiarPagina(delta) {
    if (paginaActual + delta >= 0 && paginaActual + delta < album.length) {
      paginaActual += delta;
      renderizarAlbum();
    }
  }

  function renderizarMisiones(misiones) {
    const grid = document.getElementById('grid-misiones');
    grid.innerHTML = '';

    misiones.forEach((mision, index) => {
      const card = document.createElement('div');
      card.className = 'card';
      if (mision.estado === 'bloqueada') card.classList.add('locked');
      if (mision.estado === 'completada') card.classList.add('flipped');

      const inner = document.createElement('div');
      inner.className = 'card-inner';

      const front = document.createElement('div');
      front.className = 'card-front';
      front.innerHTML = `<div>${mision.nombre}</div>`;

      const back = document.createElement('div');
      back.className = 'card-back';

      const titulo = document.createElement('h4');
      titulo.textContent = mision.nombre;
      back.appendChild(titulo);

      if (mision.estado === 'completada' && mision.imagen) {
        const img = document.createElement('img');
        img.src = mision.imagen;
        back.appendChild(img);
      } else if (mision.estado === 'desbloqueada') {
        const input = document.createElement('input');
        input.type = 'file';
        input.accept = 'image/*';

        const btn = document.createElement('button');
        btn.textContent = 'Subir foto';
        btn.onclick = () => {
          const file = input.files[0];
          if (!file) return alert('Selecciona una imagen');

          const reader = new FileReader();
          reader.onload = () => {
            mision.imagen = reader.result;
            mision.estado = 'completada';

            if (index + 1 < misiones.length && misiones[index + 1].estado === 'bloqueada') {
              misiones[index + 1].estado = 'desbloqueada';
            }
            renderizarAlbum();
          };
          reader.readAsDataURL(file);
        };

        back.appendChild(input);
        back.appendChild(btn);
      }

      inner.appendChild(front);
      inner.appendChild(back);
      card.appendChild(inner);
      grid.appendChild(card);

      if (mision.estado !== 'bloqueada') {
        card.addEventListener('click', (e) => {
          if (e.target.tagName === 'INPUT' || e.target.tagName === 'BUTTON') return;
          card.classList.toggle('flipped');
        });
      }
    });
  }

  renderizarAlbum();
</script>

</body>
</html>

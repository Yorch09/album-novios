<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>√Ålbum por Misiones - Cartas</title>
  <style>
    body {
      font-family: sans-serif;
      background: #f0f0f0;
      padding: 20px;
    }

    h1 {
      text-align: center;
    }

    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
      gap: 20px;
      max-width: 1000px;
      margin: auto;
    }

    .card {
      perspective: 1000px;
    }

    .card-inner {
      position: relative;
      width: 100%;
      padding-top: 140%; /* Relaci√≥n 7:5 */
      transform-style: preserve-3d;
      transition: transform 0.6s;
    }

    .card.flipped .card-inner {
      transform: rotateY(180deg);
    }

    .card-front, .card-back {
      position: absolute;
      top: 0; left: 0; right: 0; bottom: 0;
      backface-visibility: hidden;
      border-radius: 10px;
      box-shadow: 0 4px 8px rgba(0,0,0,0.2);
    }

    .card-front {
      background: url('https://i.imgur.com/4m2V3rZ.png') center/cover no-repeat; /* Imagen reverso */
    }

    .card-back {
      background: white;
      transform: rotateY(180deg);
      padding: 10px;
      box-sizing: border-box;
      text-align: center;
    }

    .card-back img {
      width: 100%;
      border-radius: 8px;
      margin-top: 10px;
    }

    .card.locked .card-front {
      filter: grayscale(100%);
      cursor: not-allowed;
    }

    .card:not(.locked) .card-front {
      cursor: pointer;
    }

    input[type="file"] {
      margin-top: 10px;
    }

    button {
      margin-top: 10px;
      padding: 5px 10px;
      border: none;
      background: #007bff;
      color: white;
      border-radius: 5px;
      cursor: pointer;
    }

    button:hover {
      background: #0056b3;
    }
  </style>
</head>
<body>

<h1>√Ålbum por Misiones üíå</h1>
<div class="grid" id="grid-misiones"></div>

<script>
  const misiones = [
    { nombre: "Primera cita", estado: "desbloqueada", imagen: null },
    { nombre: "Atardecer juntos", estado: "bloqueada", imagen: null },
    { nombre: "Viaje sorpresa", estado: "bloqueada", imagen: null }
  ];

  const grid = document.getElementById('grid-misiones');

  function renderizar() {
    grid.innerHTML = '';
    misiones.forEach((mision, index) => {
      const card = document.createElement('div');
      card.className = 'card';
      if (mision.estado === 'bloqueada') card.classList.add('locked');
      if (mision.estado === 'completada') card.classList.add('flipped');

      const inner = document.createElement('div');
      inner.className = 'card-inner';

      // Parte delantera (reverso de carta)
      const front = document.createElement('div');
      front.className = 'card-front';
      front.title = mision.nombre;

      // Parte trasera (interior de misi√≥n)
      const back = document.createElement('div');
      back.className = 'card-back';

      const titulo = document.createElement('h4');
      titulo.textContent = mision.nombre;
      back.appendChild(titulo);

      if (mision.estado === 'completada' && mision.imagen) {
        const img = document.createElement('img');
        img.src = mision.imagen;
        back.appendChild(img);
      } else if (mision.estado === 'desbloqueada') {
        const input = document.createElement('input');
        input.type = 'file';
        input.accept = 'image/*';

        const btn = document.createElement('button');
        btn.textContent = 'Subir foto';
        btn.onclick = () => {
          const file = input.files[0];
          if (!file) return alert('Selecciona una imagen');

          const reader = new FileReader();
          reader.onload = () => {
            mision.imagen = reader.result;
            mision.estado = 'completada';
            if (index + 1 < misiones.length && misiones[index + 1].estado === 'bloqueada') {
              misiones[index + 1].estado = 'desbloqueada';
            }
            renderizar();
          };
          reader.readAsDataURL(file);
        };

        back.appendChild(input);
        back.appendChild(btn);
      }

      inner.appendChild(front);
      inner.appendChild(back);
      card.appendChild(inner);
      grid.appendChild(card);

      // Click para girar solo si est√° desbloqueada o completada
      if (mision.estado !== 'bloqueada') {
        card.addEventListener('click', (e) => {
          if (e.target.tagName === 'INPUT' || e.target.tagName === 'BUTTON') return;
          card.classList.toggle('flipped');
        });
      }
    });
  }

  renderizar();
</script>

</body>
</html>
